# 🗺️ مخطط تدفق رحلة الضيف (Guest Journey Flow)

## 📋 نظرة عامة
هذا المستند يوضح التدفق الكامل لرحلة المستخدم الضيف في تطبيق DineBuddies من التسجيل حتى إتمام اللقاء.

---

## 🎯 المخطط الرئيسي

```
┌─────────────────────────────────────────────────────────────────┐
│                    🚀 بداية رحلة الضيف                          │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  1️⃣ التسجيل والإعداد الأولي                                    │
│  ────────────────────────────                                   │
│  ✓ إنشاء حساب (Firebase Auth)                                  │
│  ✓ إدخال الاسم                                                 │
│  ✓ اختيار الجنس (إلزامي) 👨/👩                                │
│  ✓ إدخال العمر (≥18) 🎂                                        │
│  ✓ رفع صورة شخصية 📸                                           │
│  ✓ كتابة البايو (اختياري) 📝                                   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  2️⃣ استكشاف الدعوات                                            │
│  ────────────────────                                           │
│  🔍 تصفح الصفحة الرئيسية                                       │
│  📊 عرض بطاقات الدعوات                                         │
│  🎯 فلترة حسب:                                                 │
│     • النوع (مطعم، مقهى، سينما)                                │
│     • الموقع 📍                                                 │
│     • التاريخ 📅                                                │
│     • نوع الدفع 💰                                              │
│  📏 عرض المسافة ووقت السفر                                     │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  3️⃣ التحقق من الأهلية                                          │
│  ──────────────────────                                         │
│  ┌─────────────────────────────────────┐                        │
│  │ هل الجنس مطابق للتفضيلات؟          │                        │
│  └─────────────────────────────────────┘                        │
│           │ نعم              │ لا                              │
│           ▼                  ▼                                  │
│  ┌─────────────────┐  ┌──────────────────┐                     │
│  │ هل العمر مناسب؟ │  │ ❌ غير مؤهل      │                     │
│  └─────────────────┘  │ عرض السبب       │                     │
│           │ نعم        └──────────────────┘                     │
│           ▼                                                     │
│  ┌─────────────────────────────────────┐                        │
│  │ ✅ مؤهل للانضمام                    │                        │
│  └─────────────────────────────────────┘                        │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  4️⃣ طلب الانضمام                                               │
│  ────────────────                                               │
│  👆 الضغط على زر "Join"                                        │
│  📤 إرسال الطلب إلى المضيف                                     │
│  🔔 إشعار المضيف بالطلب الجديد                                 │
│  ⏳ حالة الطلب: "Pending"                                      │
│  💬 عرض رسالة "Request Sent - Waiting for approval"           │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  5️⃣ انتظار قرار المضيف                                         │
│  ──────────────────────                                         │
│           ┌───────────────────────┐                             │
│           │ قرار المضيف؟          │                             │
│           └───────────────────────┘                             │
│                 │                                               │
│        ┌────────┴────────┐                                      │
│        ▼                 ▼                                      │
│  ┌──────────┐      ┌──────────┐                                │
│  │ ✅ قبول  │      │ ❌ رفض   │                                │
│  └──────────┘      └──────────┘                                │
│        │                 │                                      │
│        │                 ▼                                      │
│        │           ┌──────────────────────┐                     │
│        │           │ 🔔 إشعار بالرفض      │                     │
│        │           │ يمكن إعادة الطلب     │                     │
│        │           └──────────────────────┘                     │
│        │                                                        │
│        ▼                                                        │
│  ┌──────────────────────────────────────┐                       │
│  │ 🎉 تمت الموافقة!                     │                       │
│  │ 🔔 إشعار بالقبول                     │                       │
│  │ ➕ إضافة إلى joined[]                │                       │
│  │ 🔓 فتح الوصول الكامل                 │                       │
│  └──────────────────────────────────────┘                       │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  6️⃣ المشاركة النشطة                                            │
│  ──────────────────                                             │
│  ┌────────────────────────────────────────┐                     │
│  │ 👥 عرض جميع الأعضاء                   │                     │
│  │    • المضيف (HOST badge)              │                     │
│  │    • الأعضاء المنضمين                 │                     │
│  │    • الأماكن الفارغة (?)              │                     │
│  └────────────────────────────────────────┘                     │
│                                                                 │
│  ┌────────────────────────────────────────┐                     │
│  │ 💬 الدردشة الجماعية                   │                     │
│  │    • إرسال رسائل فورية                │                     │
│  │    • رؤية رسائل الجميع                │                     │
│  │    • عرض الصور والأسماء               │                     │
│  └────────────────────────────────────────┘                     │
│                                                                 │
│  ┌────────────────────────────────────────┐                     │
│  │ 🚗 تتبع رحلة اللقاء                   │                     │
│  │    Planning → On Way → Arrived         │                     │
│  │       🖊️        🚗        📍            │                     │
│  └────────────────────────────────────────┘                     │
│                                                                 │
│  ┌────────────────────────────────────────┐                     │
│  │ ⚠️ الموافقة على تغيير الوقت (إن وجد) │                     │
│  │    • إشعار بالتغيير                   │                     │
│  │    • خيارات: موافقة / انسحاب          │                     │
│  └────────────────────────────────────────┘                     │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  7️⃣ رحلة اللقاء (Meeting Journey)                              │
│  ─────────────────────────────────                              │
│                                                                 │
│  ┌─────────────────────┐                                        │
│  │ 🖊️ Planning         │ الحالة الأولية                        │
│  └─────────────────────┘                                        │
│           │                                                     │
│           │ الضيف يضغط "I'm on my way"                         │
│           ▼                                                     │
│  ┌─────────────────────┐                                        │
│  │ 🚗 On Way           │ في الطريق                             │
│  └─────────────────────┘                                        │
│           │                                                     │
│           │ الضيف يضغط "I've arrived"                          │
│           ▼                                                     │
│  ┌─────────────────────┐                                        │
│  │ 📍 Arrived          │ وصل للمكان                            │
│  └─────────────────────┘                                        │
│           │                                                     │
│           │ المضيف يضغط "Complete Meeting"                     │
│           ▼                                                     │
│  ┌─────────────────────┐                                        │
│  │ ✅ Completed        │ اكتمل اللقاء                          │
│  └─────────────────────┘                                        │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  8️⃣ التقييم والمكافآت                                          │
│  ────────────────────                                           │
│  ⭐ تقييم التجربة (1-5 نجوم)                                   │
│  🏆 كسب نقاط السمعة (Reputation Points)                        │
│  📊 تحديث الإحصائيات:                                          │
│     • عدد اللقاءات المكتملة +1                                 │
│     • عدد التقييمات المعطاة +1                                 │
│  💬 إمكانية كتابة تعليق (اختياري)                              │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  9️⃣ دورة حياة الدعوة بعد الاكتمال                              │
│  ──────────────────────────────────                             │
│                                                                 │
│  ⏰ بعد الاكتمال مباشرة:                                       │
│     • عرض الدعوة بعنوان "Completed"                            │
│     • بقاء الدعوة مرئية لمدة ساعة                              │
│                                                                 │
│  ⏰ بعد ساعة واحدة:                                            │
│     • إخفاء الدعوة من الصفحة الرئيسية                          │
│     • بقاء الدعوة نشطة في الخلفية                              │
│                                                                 │
│  ⏰ بعد 24 ساعة:                                               │
│     • حذف الدعوة نهائياً                                       │
│     • حذف الدردشة الجماعية                                     │
│     • حذف جميع البيانات المرتبطة                               │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                    🎉 نهاية رحلة الضيف                          │
│                   يمكن البدء برحلة جديدة!                       │
└─────────────────────────────────────────────────────────────────┘
```

---

## 🔀 المسارات البديلة

### 🚫 مسار الرفض
```
طلب الانضمام → رفض المضيف → إشعار بالرفض
                                    │
                                    ▼
                          ┌──────────────────┐
                          │ خيارات الضيف:    │
                          │ 1. إعادة الطلب   │
                          │ 2. البحث عن دعوة │
                          │    أخرى          │
                          │ 3. الإبلاغ عن    │
                          │    المضيف (إذا   │
                          │    كان هناك سبب) │
                          └──────────────────┘
```

### ⏰ مسار تغيير الوقت
```
المضيف يغير الوقت → إشعار لجميع الأعضاء
                              │
                              ▼
                    ┌──────────────────┐
                    │ خيارات الضيف:    │
                    │ 1. ✅ الموافقة   │
                    │ 2. ❌ الانسحاب   │
                    └──────────────────┘
                              │
                    ┌─────────┴─────────┐
                    ▼                   ▼
              ┌──────────┐        ┌──────────┐
              │ الموافقة │        │ الانسحاب │
              │ البقاء   │        │ إزالة من │
              │ في joined│        │ joined[] │
              └──────────┘        └──────────┘
```

### 🚨 مسار الإبلاغ
```
الضيف يرى محتوى مخالف → الضغط على 🚩
                              │
                              ▼
                    ┌──────────────────┐
                    │ نافذة الإبلاغ:   │
                    │ • نوع المخالفة   │
                    │ • الوصف          │
                    │ • الأدلة         │
                    └──────────────────┘
                              │
                              ▼
                    ┌──────────────────┐
                    │ إرسال للمراجعة   │
                    │ من قبل الإدارة   │
                    └──────────────────┘
```

---

## 📊 حالات الدعوة من منظور الضيف

```
┌─────────────────────────────────────────────────────────────────┐
│                        حالات الدعوة                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  🟢 Available (متاحة)                                           │
│     • أماكن فارغة موجودة                                        │
│     • الضيف مؤهل (الجنس + العمر)                               │
│     • زر: "Join"                                                │
│                                                                 │
│  🟡 Pending (قيد الانتظار)                                      │
│     • تم إرسال الطلب                                            │
│     • في انتظار موافقة المضيف                                   │
│     • زر: "Request Pending"                                     │
│                                                                 │
│  🟢 Accepted (مقبول)                                            │
│     • تمت الموافقة                                              │
│     • وصول كامل للدعوة                                          │
│     • زر: "Request Approved" أو "Manage"                        │
│                                                                 │
│  🔴 Full (ممتلئة)                                               │
│     • لا توجد أماكن فارغة                                       │
│     • زر معطل                                                   │
│                                                                 │
│  ⚫ Ineligible (غير مؤهل)                                       │
│     • الجنس غير مطابق                                           │
│     • العمر غير مناسب                                           │
│     • زر معطل مع عرض السبب                                      │
│                                                                 │
│  🟣 Completed (مكتملة)                                          │
│     • اللقاء انتهى                                              │
│     • يمكن التقييم                                              │
│     • ستُحذف بعد 24 ساعة                                        │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 🎯 نقاط القرار الحرجة

### 1️⃣ قبل طلب الانضمام:
```
هل أنا مؤهل؟
  ├─ نعم → إرسال الطلب
  └─ لا → عرض السبب + البحث عن دعوة أخرى
```

### 2️⃣ بعد استلام إشعار تغيير الوقت:
```
هل الوقت الجديد مناسب؟
  ├─ نعم → الموافقة والبقاء
  └─ لا → الانسحاب من الدعوة
```

### 3️⃣ عند الوصول للمكان:
```
هل وصلت فعلاً؟
  ├─ نعم → تحديث الحالة إلى "Arrived"
  └─ لا → البقاء في "On Way"
```

### 4️⃣ بعد اكتمال اللقاء:
```
هل تريد تقييم التجربة؟
  ├─ نعم → اختيار النجوم (1-5) + كسب نقاط
  └─ لا → تخطي (لن تكسب نقاط إضافية)
```

---

## 🔔 الإشعارات على طول الرحلة

```
┌─────────────────────────────────────────────────────────────────┐
│                     جدول الإشعارات                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  📬 عند قبول الطلب:                                            │
│     "✅ تمت الموافقة على طلبك للانضمام إلى [اسم الدعوة]"       │
│                                                                 │
│  📬 عند رفض الطلب:                                             │
│     "❌ تم رفض طلبك للانضمام إلى [اسم الدعوة]"                 │
│                                                                 │
│  📬 عند تغيير الوقت:                                           │
│     "⏰ تم تغيير وقت [اسم الدعوة]. يرجى الموافقة أو الانسحاب"  │
│                                                                 │
│  📬 عند رسالة جديدة:                                           │
│     "💬 رسالة جديدة في [اسم الدعوة] من [اسم المرسل]"          │
│                                                                 │
│  📬 عند اكتمال اللقاء:                                         │
│     "🎉 اكتمل لقاء [اسم الدعوة]! قيّم تجربتك واكسب نقاط"      │
│                                                                 │
│  📬 عند انضمام عضو جديد:                                       │
│     "👥 انضم [اسم العضو] إلى [اسم الدعوة]"                    │
│                                                                 │
│  📬 قبل موعد اللقاء بساعة:                                     │
│     "⏰ تذكير: لقاء [اسم الدعوة] بعد ساعة في [المكان]"        │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 📱 الشاشات الرئيسية

### 1. الصفحة الرئيسية
```
┌─────────────────────────┐
│ 🔍 Search Bar           │
├─────────────────────────┤
│ 🎛️ Filters              │
├─────────────────────────┤
│ 📋 Invitation Cards     │
│ ┌─────────────────────┐ │
│ │ Card 1              │ │
│ └─────────────────────┘ │
│ ┌─────────────────────┐ │
│ │ Card 2              │ │
│ └─────────────────────┘ │
│ ┌─────────────────────┐ │
│ │ Card 3              │ │
│ └─────────────────────┘ │
└─────────────────────────┘
```

### 2. تفاصيل الدعوة (قبل القبول)
```
┌─────────────────────────┐
│ ← Back  Title  Share → │
├─────────────────────────┤
│ 📸 Cover Image          │
│ 📝 Description          │
│ 📍 Location             │
│ 📅 Date | 🕐 Time       │
│ 👥 Guests | 💰 Payment  │
│ 📏 Distance | ⏱️ Travel │
├─────────────────────────┤
│ [Join Button]           │
└─────────────────────────┘
```

### 3. تفاصيل الدعوة (بعد القبول)
```
┌─────────────────────────┐
│ ← Back  Title  Share → │
├─────────────────────────┤
│ 📸 Cover Image          │
│ 📝 Description          │
│ 📍 Location             │
│ 📅 Date | 🕐 Time       │
├─────────────────────────┤
│ 🚗 Journey Timeline     │
│ Planning→OnWay→Arrived  │
│ [Action Buttons]        │
├─────────────────────────┤
│ 👥 Members List         │
│ • Host (YOU/OTHER)      │
│ • Member 1              │
│ • Member 2              │
│ • Empty Spots           │
├─────────────────────────┤
│ 💬 Group Chat           │
│ [Messages]              │
│ [Input Field]           │
└─────────────────────────┘
```

### 4. البروفايل الشخصي
```
┌─────────────────────────┐
│ ⚙️ Settings             │
├─────────────────────────┤
│ 📸 Avatar               │
│ 👤 Name                 │
│ 📝 Bio                  │
│ 👨/👩 Gender | 🎂 Age   │
├─────────────────────────┤
│ 📊 Stats                │
│ Followers | Following   │
├─────────────────────────┤
│ 📋 Tabs                 │
│ Posted | Joined         │
│ [Invitations List]      │
├─────────────────────────┤
│ 🌍 Language Selector    │
└─────────────────────────┘
```

---

## 🎨 الألوان والحالات

```
┌─────────────────────────────────────────────────────────────────┐
│                    دليل الألوان والأيقونات                     │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  🟢 أخضر → متاح / نشط / موافقة                                 │
│  🟡 أصفر → قيد الانتظار / تحذير                                │
│  🔴 أحمر → ممتلئ / رفض / خطأ                                   │
│  🔵 أزرق → معلومات / رسائل                                     │
│  🟣 بنفسجي → مكتمل / خاص                                       │
│  ⚫ رمادي → معطل / غير مؤهل                                    │
│  🟠 برتقالي → إشعار مهم                                        │
│  🟤 بني → محايد                                                │
│                                                                 │
│  ✅ علامة صح → نجاح / موافقة                                   │
│  ❌ علامة خطأ → رفض / فشل                                      │
│  ⏳ ساعة رملية → انتظار                                        │
│  🔔 جرس → إشعار                                                │
│  💬 فقاعة → رسالة                                              │
│  👥 مجموعة → أعضاء                                             │
│  📍 دبوس → موقع                                                │
│  🚗 سيارة → في الطريق                                          │
│  ⭐ نجمة → تقييم / سمعة                                        │
│  🏆 كأس → إنجاز / مكافأة                                       │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 🔐 الأمان والخصوصية

### مستويات الوصول:
```
┌─────────────────────────────────────────────────────────────────┐
│                      مستويات الوصول                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  🌍 عام (Public):                                              │
│     • معلومات الدعوة الأساسية                                  │
│     • اسم وصورة المضيف                                          │
│     • الموقع والتاريخ والوقت                                   │
│     • عدد الأماكن المتاحة                                       │
│                                                                 │
│  🔒 خاص - بعد القبول (Private):                                │
│     • قائمة الأعضاء الكاملة                                     │
│     • الدردشة الجماعية                                          │
│     • تحديثات الحالة                                            │
│     • معلومات الاتصال (إن وجدت)                                │
│                                                                 │
│  👑 المضيف فقط (Host Only):                                    │
│     • طلبات الانضمام                                            │
│     • قبول/رفض الأعضاء                                          │
│     • تغيير الوقت/التاريخ                                       │
│     • إكمال اللقاء                                              │
│     • حذف الدعوة                                                │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

**تم إعداد هذا المخطط بواسطة:** Antigravity AI  
**التاريخ:** 2026-02-03  
**الإصدار:** 1.0
