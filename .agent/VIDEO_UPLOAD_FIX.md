# ๐ฅ ุฅุตูุงุญ ูุดููุฉ ุฑูุน ุงูููุฏูู ููุฏุนูุงุช

## ๐ ุชุดุฎูุต ุงููุดููุฉ

### ุงููุดููุฉ ุงูุฃุณุงุณูุฉ
ูุงู ุงููุณุชุฎุฏููู ููุงุฌููู ุฎุทุฃ `storage/unauthorized` ุนูุฏ ูุญุงููุฉ ุฑูุน ููุฏูููุงุช ููุฏุนูุงุช.

### ุงูุณุจุจ ุงูุฌุฐุฑู
ููุงุนุฏ Firebase Storage ูุงูุช ุชุณูุญ **ููุท ุจุงูุตูุฑ** ูููุณ ุงูููุฏูููุงุช:

```javascript
// ุงูููุงุนุฏ ุงููุฏููุฉ (โ ุฎุงุทุฆุฉ)
match /invitations/{invitationId}/{filename} {
  allow write: if isAuthenticated()
               && isValidSize()
               && isImage(); // โ ููุง ุงููุดููุฉ - ููุท ุงูุตูุฑ!
}
```

---

## โ ุงูุญู ุงููุทุจู

### 1. ุชุญุฏูุซ ููุงุนุฏ Storage (`storage.rules`)

#### ุฅุถุงูุฉ ุฏูุงู ูุณุงุนุฏุฉ ุฌุฏูุฏุฉ:
```javascript
// Helper function to check video size (max 50MB)
function isValidVideoSize() {
  return request.resource.size < 50 * 1024 * 1024;
}

// Helper function to check if file is a video
function isVideo() {
  return request.resource.contentType.matches('video/.*');
}
```

#### ุชุญุฏูุซ ููุงุนุฏ ุงูุฏุนูุงุช:
```javascript
// Invitation media (images and videos)
match /invitations/{userId}/{filename} {
  // Anyone can read invitation media
  allow read: if true;
  
  // Only authenticated users can upload their invitation media
  // Images: max 5MB | Videos: max 50MB
  allow write: if isAuthenticated()
               && (
                 (isImage() && isValidSize()) || 
                 (isVideo() && isValidVideoSize())
               );
}
```

### 2. ุฅุถุงูุฉ ุฅุนุฏุงุฏุงุช Storage ูู Firebase (`firebase.json`)

```json
"storage": {
    "rules": "storage.rules"
}
```

### 3. ูุดุฑ ุงูููุงุนุฏ ุงูุฌุฏูุฏุฉ

```bash
firebase deploy --only storage
```

โ **ุชู ุงูุชูููุฐ ูุฏููุงู ูู ูุจู ุงููุณุชุฎุฏู**

---

## ๐ ุงูููุงุตูุงุช ุงูููุงุฆูุฉ

### ุญุฏูุฏ ุงูุญุฌู:
- **ุงูุตูุฑ**: ุญุฏ ุฃูุตู **5MB**
- **ุงูููุฏูููุงุช**: ุญุฏ ุฃูุตู **50MB**

### ุญุฏูุฏ ุงููุฏุฉ (ูู ุงููุงุฌูุฉ):
- **ุงูููุฏูููุงุช**: ุญุฏ ุฃูุตู **30 ุซุงููุฉ**

### ุงููุณุงุฑ ูู Storage:
```
invitations/{userId}/{timestamp}_{type}.{extension}
```

ูุซุงู:
```
invitations/abc123/1707583920000_video.webm
invitations/abc123/1707583920000_thumbnail.jpg
```

---

## ๐ ุงูุฃูู

### ูุชุทูุจุงุช ุงูุฑูุน:
1. โ ุงููุณุชุฎุฏู ูุณุฌู ุฏุฎูู (`isAuthenticated()`)
2. โ ุงูุญุฌู ุถูู ุงูุญุฏูุฏ ุงููุณููุญุฉ
3. โ ููุน ุงูููู ุตุญูุญ (image/* ุฃู video/*)

### ุงูุตูุงุญูุงุช:
- **ุงููุฑุงุกุฉ**: ููุชูุญุฉ ููุฌููุน (ููุนุฑุถ ุงูุนุงู)
- **ุงููุชุงุจุฉ**: ููุท ุงููุณุชุฎุฏููู ุงููุณุฌููู

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### ูุงุฎุชุจุงุฑ ุงูุฅุตูุงุญ:
1. ุงูุชุญ ุตูุญุฉ ุฅูุดุงุก ุฏุนูุฉ ุฌุฏูุฏุฉ
2. ุงุฎุชุฑ "Video" ูู ุฎูุงุฑุงุช ุงููุณุงุฆุท
3. ุณุฌู ููุฏูู ุฃู ุงุฑูุน ููุฏูู (ุฃูู ูู 30 ุซุงููุฉ ู 50MB)
4. ุงูุชูู ูููุนุงููุฉ
5. ุงูุดุฑ ุงูุฏุนูุฉ

### ุงููุชูุฌุฉ ุงููุชููุนุฉ:
โ ูุชู ุฑูุน ุงูููุฏูู ุจูุฌุงุญ  
โ ูุชู ุฅูุดุงุก thumbnail ุชููุงุฆูุงู  
โ ุชุธูุฑ ุงูุฏุนูุฉ ูุน ุงูููุฏูู ุจุดูู ุตุญูุญ

---

## ๐ ุงููููุงุช ุงููุนุฏูุฉ

1. **`storage.rules`** - ุชุญุฏูุซ ุงูููุงุนุฏ ูุฏุนู ุงูููุฏูููุงุช
2. **`firebase.json`** - ุฅุถุงูุฉ ุฅุนุฏุงุฏุงุช Storage

## ๐ ุงููููุงุช ุฐุงุช ุงูุตูุฉ (ูู ุชุชุบูุฑ)

- โ `src/services/mediaService.js` - ููุทู ุฑูุน ุงููุณุงุฆุท
- โ `src/components/Invitations/MediaSelector.jsx` - ูุงุฌูุฉ ุงุฎุชูุงุฑ ุงููุณุงุฆุท
- โ `src/components/Shared/MediaUpload.jsx` - ูููู ุฑูุน ุงููุณุงุฆุท
- โ `src/pages/CreateInvitation.jsx` - ุตูุญุฉ ุฅูุดุงุก ุงูุฏุนูุงุช

---

## ๐ฏ ุงูุฎูุงุตุฉ

**ุงููุดููุฉ**: ููุงุนุฏ Firebase ูุงูุช ุชุฑูุถ ุงูููุฏูููุงุช  
**ุงูุญู**: ุชุญุฏูุซ ุงูููุงุนุฏ ููุณูุงุญ ุจุงูููุฏูููุงุช ูุน ุญุฏูุฏ ุญุฌู ุฃูุจุฑ  
**ุงูุญุงูุฉ**: โ **ุชู ุงูุฅุตูุงุญ ูุงููุดุฑ**

---

**ุชุงุฑูุฎ ุงูุฅุตูุงุญ:** 2026-02-10  
**ุงููุทูุฑ:** Antigravity AI  
**ุงูุญุงูุฉ:** ููุชูู โ
